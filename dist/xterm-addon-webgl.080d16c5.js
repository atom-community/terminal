("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire66c3.register("91a3O",(function(t,e){var i,r;i=self,r=function(){return(()=>{function t(r){var o=i[r];if(void 0!==o)return o.exports;var s=i[r]={exports:{}};return e[r].call(s.exports,s,s.exports,t),s.exports}var e={965(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.GlyphRenderer=void 0;var r=i(381),o=i(310),s=i(455),n=i(259),a=i(855),l=i(147),h=10,c=h*Float32Array.BYTES_PER_ELEMENT,_=function(){function t(t,e,i,o){this._terminal=t,this._colors=e,this._gl=i,this._dimensions=o,this._activeBuffer=0,this._vertices={count:0,attributes:new Float32Array(0),attributesBuffers:[new Float32Array(0),new Float32Array(0)],selectionAttributes:new Float32Array(0)};var s=this._gl,n=r.throwIfFalsy(r.createProgram(s,"#version 300 es\nlayout (location = 0) in vec2 a_unitquad;\nlayout (location = 1) in vec2 a_cellpos;\nlayout (location = 2) in vec2 a_offset;\nlayout (location = 3) in vec2 a_size;\nlayout (location = 4) in vec2 a_texcoord;\nlayout (location = 5) in vec2 a_texsize;\n\nuniform mat4 u_projection;\nuniform vec2 u_resolution;\n\nout vec2 v_texcoord;\n\nvoid main() {\n  vec2 zeroToOne = (a_offset / u_resolution) + a_cellpos + (a_unitquad * a_size);\n  gl_Position = u_projection * vec4(zeroToOne, 0.0, 1.0);\n  v_texcoord = a_texcoord + a_unitquad * a_texsize;\n}","#version 300 es\nprecision lowp float;\n\nin vec2 v_texcoord;\n\nuniform sampler2D u_texture;\n\nout vec4 outColor;\n\nvoid main() {\n  outColor = texture(u_texture, v_texcoord);\n}"));this._program=n,this._projectionLocation=r.throwIfFalsy(s.getUniformLocation(this._program,"u_projection")),this._resolutionLocation=r.throwIfFalsy(s.getUniformLocation(this._program,"u_resolution")),this._textureLocation=r.throwIfFalsy(s.getUniformLocation(this._program,"u_texture")),this._vertexArrayObject=s.createVertexArray(),s.bindVertexArray(this._vertexArrayObject);var a=new Float32Array([0,0,1,0,0,1,1,1]),l=s.createBuffer();s.bindBuffer(s.ARRAY_BUFFER,l),s.bufferData(s.ARRAY_BUFFER,a,s.STATIC_DRAW),s.enableVertexAttribArray(0),s.vertexAttribPointer(0,2,this._gl.FLOAT,!1,0,0);var h=new Uint8Array([0,1,3,0,2,3]),_=s.createBuffer();s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,_),s.bufferData(s.ELEMENT_ARRAY_BUFFER,h,s.STATIC_DRAW),this._attributesBuffer=r.throwIfFalsy(s.createBuffer()),s.bindBuffer(s.ARRAY_BUFFER,this._attributesBuffer),s.enableVertexAttribArray(2),s.vertexAttribPointer(2,2,s.FLOAT,!1,c,0),s.vertexAttribDivisor(2,1),s.enableVertexAttribArray(3),s.vertexAttribPointer(3,2,s.FLOAT,!1,c,2*Float32Array.BYTES_PER_ELEMENT),s.vertexAttribDivisor(3,1),s.enableVertexAttribArray(4),s.vertexAttribPointer(4,2,s.FLOAT,!1,c,4*Float32Array.BYTES_PER_ELEMENT),s.vertexAttribDivisor(4,1),s.enableVertexAttribArray(5),s.vertexAttribPointer(5,2,s.FLOAT,!1,c,6*Float32Array.BYTES_PER_ELEMENT),s.vertexAttribDivisor(5,1),s.enableVertexAttribArray(1),s.vertexAttribPointer(1,2,s.FLOAT,!1,c,8*Float32Array.BYTES_PER_ELEMENT),s.vertexAttribDivisor(1,1),this._atlasTexture=r.throwIfFalsy(s.createTexture()),s.bindTexture(s.TEXTURE_2D,this._atlasTexture),s.texImage2D(s.TEXTURE_2D,0,s.RGBA,1,1,0,s.RGBA,s.UNSIGNED_BYTE,new Uint8Array([0,0,255,255])),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE),s.enable(s.BLEND),s.blendFunc(s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA),this.onResize()}return t.prototype.beginFrame=function(){return!this._atlas||this._atlas.beginFrame()},t.prototype.updateCell=function(t,e,i,r,o,s){this._updateCell(this._vertices.attributes,t,e,i,r,o,s)},t.prototype._updateCell=function(t,e,i,r,o,n,l){var c,_=(i*this._terminal.cols+e)*h;r!==a.NULL_CELL_CODE&&r!==a.WHITESPACE_CELL_CODE&&void 0!==r?this._atlas&&((c=l&&l.length>1?this._atlas.getRasterizedGlyphCombinedChar(l,o,n):this._atlas.getRasterizedGlyph(r,o,n))?(t[_]=-c.offset.x+this._dimensions.scaledCharLeft,t[_+1]=-c.offset.y+this._dimensions.scaledCharTop,t[_+2]=c.size.x/this._dimensions.scaledCanvasWidth,t[_+3]=c.size.y/this._dimensions.scaledCanvasHeight,t[_+4]=c.texturePositionClipSpace.x,t[_+5]=c.texturePositionClipSpace.y,t[_+6]=c.sizeClipSpace.x,t[_+7]=c.sizeClipSpace.y):s.fill(t,0,_,_+h-1-2)):s.fill(t,0,_,_+h-1-2)},t.prototype.updateSelection=function(t){var e=this._terminal;this._vertices.selectionAttributes=n.slice(this._vertices.attributes,0);var i=this._colors.selectionOpaque.rgba>>>8|50331648;if(t.selection.columnSelectMode)for(var r=t.selection.startCol,o=t.selection.endCol-r,s=t.selection.viewportCappedEndRow-t.selection.viewportCappedStartRow+1,a=t.selection.viewportCappedStartRow;t.selection.viewportCappedStartRow+s>a;a++)this._updateSelectionRange(r,r+o,a,t,i);else{var l=t.selection.viewportCappedStartRow===t.selection.viewportCappedEndRow?t.selection.endCol:e.cols;this._updateSelectionRange(r=t.selection.viewportStartRow===t.selection.viewportCappedStartRow?t.selection.startCol:0,l,t.selection.viewportCappedStartRow,t,i);var h=Math.max(t.selection.viewportCappedEndRow-t.selection.viewportCappedStartRow-1,0);for(a=t.selection.viewportCappedStartRow+1;t.selection.viewportCappedStartRow+h>=a;a++)this._updateSelectionRange(0,l,a,t,i);t.selection.viewportCappedStartRow!==t.selection.viewportCappedEndRow&&this._updateSelectionRange(0,t.selection.viewportEndRow===t.selection.viewportCappedEndRow?t.selection.endCol:e.cols,t.selection.viewportCappedEndRow,t,i)}},t.prototype._updateSelectionRange=function(t,e,i,r,s){for(var n,a=this._terminal,h=i+a.buffer.active.viewportY,c=t;e>c;c++){var _=(i*this._terminal.cols+c)*o.RENDER_MODEL_INDICIES_PER_CELL,d=r.cells[_],u=r.cells[_+o.RENDER_MODEL_FG_OFFSET];if(67108864&u){var p=new l.AttributeData;switch(p.fg=u,p.bg=r.cells[_+o.RENDER_MODEL_BG_OFFSET],u&=-134217728,p.getBgColorMode()){case 16777216:case 33554432:var f=this._getColorFromAnsiIndex(p.getBgColor()).rgba;u|=f>>8&16711680|f>>8&65280|f>>8&255;case 50331648:var g=l.AttributeData.toColorRGB(p.getBgColor());u|=g[0]<<16|g[1]<<8|g[2]<<0;case 0:default:var v=this._colors.background.rgba;u|=v>>8&16711680|v>>8&65280|v>>8&255}u|=50331648}if(d&o.COMBINED_CHAR_BIT_MASK){n||(n=a.buffer.active.getLine(h));var C=n.getCell(c).getChars();this._updateCell(this._vertices.selectionAttributes,c,i,r.cells[_],s,u,C)}else this._updateCell(this._vertices.selectionAttributes,c,i,r.cells[_],s,u)}},t.prototype._getColorFromAnsiIndex=function(t){if(t>=this._colors.ansi.length)throw Error("No color found for idx "+t);return this._colors.ansi[t]},t.prototype.onResize=function(){var t=this._terminal,e=this._gl;e.viewport(0,0,e.canvas.width,e.canvas.height);var i=t.cols*t.rows*h;if(this._vertices.count!==i){this._vertices.count=i,this._vertices.attributes=new Float32Array(i);for(var r=0;this._vertices.attributesBuffers.length>r;r++)this._vertices.attributesBuffers[r]=new Float32Array(i);for(var o=0,s=0;t.rows>s;s++)for(var n=0;t.cols>n;n++)this._vertices.attributes[o+8]=n/t.cols,this._vertices.attributes[o+9]=s/t.rows,o+=h}},t.prototype.setColors=()=>{},t.prototype.render=function(t,e){if(this._atlas){var i=this._gl;i.useProgram(this._program),i.bindVertexArray(this._vertexArrayObject),this._activeBuffer=(this._activeBuffer+1)%2;for(var o=this._vertices.attributesBuffers[this._activeBuffer],s=0,n=0;t.lineLengths.length>n;n++){var a=n*this._terminal.cols*h,l=(e?this._vertices.selectionAttributes:this._vertices.attributes).subarray(a,a+t.lineLengths[n]*h);o.set(l,s),s+=l.length}i.bindBuffer(i.ARRAY_BUFFER,this._attributesBuffer),i.bufferData(i.ARRAY_BUFFER,o.subarray(0,s),i.STREAM_DRAW),this._atlas.hasCanvasChanged&&(this._atlas.hasCanvasChanged=!1,i.uniform1i(this._textureLocation,0),i.activeTexture(i.TEXTURE0+0),i.bindTexture(i.TEXTURE_2D,this._atlasTexture),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,this._atlas.cacheCanvas),i.generateMipmap(i.TEXTURE_2D)),i.uniformMatrix4fv(this._projectionLocation,!1,r.PROJECTION_MATRIX),i.uniform2f(this._resolutionLocation,i.canvas.width,i.canvas.height),i.drawElementsInstanced(i.TRIANGLES,6,i.UNSIGNED_BYTE,0,s/h)}},t.prototype.setAtlas=function(t){var e=this._gl;this._atlas=t,e.bindTexture(e.TEXTURE_2D,this._atlasTexture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t.cacheCanvas),e.generateMipmap(e.TEXTURE_2D)},t.prototype.setDimensions=function(t){this._dimensions=t},t}();e.GlyphRenderer=_},344(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.RectangleRenderer=void 0;var r=i(381),o=i(455),s=i(310),n=8*Float32Array.BYTES_PER_ELEMENT,a=function(){function t(t,e,i,o){this._terminal=t,this._colors=e,this._gl=i,this._dimensions=o,this._vertices={count:0,attributes:new Float32Array(160),selection:new Float32Array(24)};var s=this._gl;this._program=r.throwIfFalsy(r.createProgram(s,"#version 300 es\nlayout (location = 0) in vec2 a_position;\nlayout (location = 1) in vec2 a_size;\nlayout (location = 2) in vec4 a_color;\nlayout (location = 3) in vec2 a_unitquad;\n\nuniform mat4 u_projection;\nuniform vec2 u_resolution;\n\nout vec4 v_color;\n\nvoid main() {\n  vec2 zeroToOne = (a_position + (a_unitquad * a_size)) / u_resolution;\n  gl_Position = u_projection * vec4(zeroToOne, 0.0, 1.0);\n  v_color = a_color;\n}","#version 300 es\nprecision lowp float;\n\nin vec4 v_color;\n\nout vec4 outColor;\n\nvoid main() {\n  outColor = v_color;\n}")),this._resolutionLocation=r.throwIfFalsy(s.getUniformLocation(this._program,"u_resolution")),this._projectionLocation=r.throwIfFalsy(s.getUniformLocation(this._program,"u_projection")),this._vertexArrayObject=s.createVertexArray(),s.bindVertexArray(this._vertexArrayObject);var a=new Float32Array([0,0,1,0,0,1,1,1]),l=s.createBuffer();s.bindBuffer(s.ARRAY_BUFFER,l),s.bufferData(s.ARRAY_BUFFER,a,s.STATIC_DRAW),s.enableVertexAttribArray(3),s.vertexAttribPointer(3,2,this._gl.FLOAT,!1,0,0);var h=new Uint8Array([0,1,3,0,2,3]),c=s.createBuffer();s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,c),s.bufferData(s.ELEMENT_ARRAY_BUFFER,h,s.STATIC_DRAW),this._attributesBuffer=r.throwIfFalsy(s.createBuffer()),s.bindBuffer(s.ARRAY_BUFFER,this._attributesBuffer),s.enableVertexAttribArray(0),s.vertexAttribPointer(0,2,s.FLOAT,!1,n,0),s.vertexAttribDivisor(0,1),s.enableVertexAttribArray(1),s.vertexAttribPointer(1,2,s.FLOAT,!1,n,2*Float32Array.BYTES_PER_ELEMENT),s.vertexAttribDivisor(1,1),s.enableVertexAttribArray(2),s.vertexAttribPointer(2,4,s.FLOAT,!1,n,4*Float32Array.BYTES_PER_ELEMENT),s.vertexAttribDivisor(2,1),this._updateCachedColors()}return t.prototype.render=function(){var t=this._gl;t.useProgram(this._program),t.bindVertexArray(this._vertexArrayObject),t.uniformMatrix4fv(this._projectionLocation,!1,r.PROJECTION_MATRIX),t.uniform2f(this._resolutionLocation,t.canvas.width,t.canvas.height),t.bindBuffer(t.ARRAY_BUFFER,this._attributesBuffer),t.bufferData(t.ARRAY_BUFFER,this._vertices.attributes,t.DYNAMIC_DRAW),t.drawElementsInstanced(this._gl.TRIANGLES,6,t.UNSIGNED_BYTE,0,this._vertices.count),t.bindBuffer(t.ARRAY_BUFFER,this._attributesBuffer),t.bufferData(t.ARRAY_BUFFER,this._vertices.selection,t.DYNAMIC_DRAW),t.drawElementsInstanced(this._gl.TRIANGLES,6,t.UNSIGNED_BYTE,0,3)},t.prototype.onResize=function(){this._updateViewportRectangle()},t.prototype.setColors=function(){this._updateCachedColors(),this._updateViewportRectangle()},t.prototype._updateCachedColors=function(){this._bgFloat=this._colorToFloat32Array(this._colors.background),this._selectionFloat=this._colorToFloat32Array(this._colors.selectionOpaque)},t.prototype._updateViewportRectangle=function(){this._addRectangleFloat(this._vertices.attributes,0,0,0,this._terminal.cols*this._dimensions.scaledCellWidth,this._terminal.rows*this._dimensions.scaledCellHeight,this._bgFloat)},t.prototype.updateSelection=function(t){var e=this._terminal;if(t.hasSelection)if(t.columnSelectMode){var i=t.startCol;this._addRectangleFloat(this._vertices.selection,0,i*this._dimensions.scaledCellWidth,t.viewportCappedStartRow*this._dimensions.scaledCellHeight,(t.endCol-i)*this._dimensions.scaledCellWidth,(t.viewportCappedEndRow-t.viewportCappedStartRow+1)*this._dimensions.scaledCellHeight,this._selectionFloat),o.fill(this._vertices.selection,0,8)}else this._addRectangleFloat(this._vertices.selection,0,(i=t.viewportStartRow===t.viewportCappedStartRow?t.startCol:0)*this._dimensions.scaledCellWidth,t.viewportCappedStartRow*this._dimensions.scaledCellHeight,((t.viewportCappedStartRow===t.viewportEndRow?t.endCol:e.cols)-i)*this._dimensions.scaledCellWidth,this._dimensions.scaledCellHeight,this._selectionFloat),this._addRectangleFloat(this._vertices.selection,8,0,(t.viewportCappedStartRow+1)*this._dimensions.scaledCellHeight,e.cols*this._dimensions.scaledCellWidth,Math.max(t.viewportCappedEndRow-t.viewportCappedStartRow-1,0)*this._dimensions.scaledCellHeight,this._selectionFloat),t.viewportCappedStartRow!==t.viewportCappedEndRow?this._addRectangleFloat(this._vertices.selection,16,0,t.viewportCappedEndRow*this._dimensions.scaledCellHeight,(t.viewportEndRow===t.viewportCappedEndRow?t.endCol:e.cols)*this._dimensions.scaledCellWidth,this._dimensions.scaledCellHeight,this._selectionFloat):o.fill(this._vertices.selection,0,16);else o.fill(this._vertices.selection,0,0)},t.prototype.updateBackgrounds=function(t){for(var e=this._terminal,i=this._vertices,r=1,o=0;e.rows>o;o++){for(var n=-1,a=0,l=0,h=!1,c=0;e.cols>c;c++){var _=(o*e.cols+c)*s.RENDER_MODEL_INDICIES_PER_CELL,d=t.cells[_+s.RENDER_MODEL_BG_OFFSET],u=t.cells[_+s.RENDER_MODEL_FG_OFFSET],p=!!(67108864&u);if(d!==a||u!==l&&(h||p)){if(0!==a||h&&0!==l){var f=8*r++;this._updateRectangle(i,f,l,a,n,c,o)}n=c,a=d,l=u,h=p}}(0!==a||h&&0!==l)&&(f=8*r++,this._updateRectangle(i,f,l,a,n,e.cols,o))}i.count=r},t.prototype._updateRectangle=function(t,e,i,o,s,n,a){var l;if(67108864&i)switch(50331648&i){case 16777216:case 33554432:l=this._colors.ansi[255&i].rgba;break;case 50331648:l=(16777215&i)<<8;break;case 0:default:l=this._colors.foreground.rgba}else switch(50331648&o){case 16777216:case 33554432:l=this._colors.ansi[255&o].rgba;break;case 50331648:l=(16777215&o)<<8;break;case 0:default:l=this._colors.background.rgba}e+4>t.attributes.length&&(t.attributes=r.expandFloat32Array(t.attributes,this._terminal.rows*this._terminal.cols*8)),this._addRectangle(t.attributes,e,s*this._dimensions.scaledCellWidth,a*this._dimensions.scaledCellHeight,(n-s)*this._dimensions.scaledCellWidth,this._dimensions.scaledCellHeight,(l>>24&255)/255,(l>>16&255)/255,(l>>8&255)/255,1)},t.prototype._addRectangle=(t,e,i,r,o,s,n,a,l,h)=>{t[e]=i,t[e+1]=r,t[e+2]=o,t[e+3]=s,t[e+4]=n,t[e+5]=a,t[e+6]=l,t[e+7]=h},t.prototype._addRectangleFloat=(t,e,i,r,o,s,n)=>{t[e]=i,t[e+1]=r,t[e+2]=o,t[e+3]=s,t[e+4]=n[0],t[e+5]=n[1],t[e+6]=n[2],t[e+7]=n[3]},t.prototype._colorToFloat32Array=t=>new Float32Array([(t.rgba>>24&255)/255,(t.rgba>>16&255)/255,(t.rgba>>8&255)/255,(255&t.rgba)/255]),t}();e.RectangleRenderer=a},310(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.RenderModel=e.COMBINED_CHAR_BIT_MASK=e.RENDER_MODEL_FG_OFFSET=e.RENDER_MODEL_BG_OFFSET=e.RENDER_MODEL_INDICIES_PER_CELL=void 0;var r=i(455);e.RENDER_MODEL_INDICIES_PER_CELL=3,e.RENDER_MODEL_BG_OFFSET=1,e.RENDER_MODEL_FG_OFFSET=2,e.COMBINED_CHAR_BIT_MASK=2147483648;var o=function(){function t(){this.cells=new Uint32Array(0),this.lineLengths=new Uint32Array(0),this.selection={hasSelection:!1,columnSelectMode:!1,viewportStartRow:0,viewportEndRow:0,viewportCappedStartRow:0,viewportCappedEndRow:0,startCol:0,endCol:0}}return t.prototype.resize=function(t,i){var r=t*i*e.RENDER_MODEL_INDICIES_PER_CELL;r!==this.cells.length&&(this.cells=new Uint32Array(r),this.lineLengths=new Uint32Array(i))},t.prototype.clear=function(){r.fill(this.cells,0,0),r.fill(this.lineLengths,0,0)},t.prototype.clearSelection=function(){this.selection.hasSelection=!1,this.selection.viewportStartRow=0,this.selection.viewportEndRow=0,this.selection.viewportCappedStartRow=0,this.selection.viewportCappedEndRow=0,this.selection.startCol=0,this.selection.endCol=0},t}();e.RenderModel=o},259(t,e){function i(t,e,i){void 0===e&&(e=0),void 0===i&&(i=t.length),0>e&&(e=(t.length+e)%t.length);for(var r=new t.constructor((i=t.length>i?(t.length+i)%t.length:t.length)-(e=Math.min(e,i))),o=0;i-e>o;++o)r[o]=t[o+e];return r}Object.defineProperty(e,"__esModule",{value:!0}),e.sliceFallback=e.slice=void 0,e.slice=(t,e,r)=>t.slice?t.slice(e,r):i(t,e,r),e.sliceFallback=i},666(t,e,i){var r,o=this&&this.__extends||(r=(t,e)=>(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&((t,e)=>{t.__proto__=e})||((t,e)=>{for(var i in e)({}).hasOwnProperty.call(e,i)&&(t[i]=e[i])}))(t,e),function(t,e){function i(){this.constructor=t}if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+e+" is not a constructor or null");r(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.JoinedCellData=e.WebglRenderer=void 0;var s=i(965),n=i(733),a=i(461),l=i(713),h=i(344),c=i(310),_=i(859),d=i(855),u=i(345),p=i(782),f=i(820),g=i(147),v=function(t){function e(e,i,r,o){var l=t.call(this)||this;if(l._terminal=e,l._colors=i,l._characterJoinerService=r,l._model=new c.RenderModel,l._workCell=new p.CellData,l._onRequestRedraw=new u.EventEmitter,l._onContextLoss=new u.EventEmitter,l._core=l._terminal._core,l._renderLayers=[new n.LinkRenderLayer(l._core.screenElement,2,l._colors,l._core),new a.CursorRenderLayer(l._core.screenElement,3,l._colors,l._onRequestRedraw)],l.dimensions={scaledCharWidth:0,scaledCharHeight:0,scaledCellWidth:0,scaledCellHeight:0,scaledCharLeft:0,scaledCharTop:0,scaledCanvasWidth:0,scaledCanvasHeight:0,canvasWidth:0,canvasHeight:0,actualCellWidth:0,actualCellHeight:0},l._devicePixelRatio=window.devicePixelRatio,l._updateDimensions(),l._canvas=document.createElement("canvas"),l._gl=l._canvas.getContext("webgl2",{antialias:!1,depth:!1,preserveDrawingBuffer:o}),!l._gl)throw Error("WebGL2 not supported "+l._gl);return l.register(f.addDisposableDomListener(l._canvas,"webglcontextlost",(t=>{l._onContextLoss.fire(t)}))),l._core.screenElement.appendChild(l._canvas),l._rectangleRenderer=new h.RectangleRenderer(l._terminal,l._colors,l._gl,l.dimensions),l._glyphRenderer=new s.GlyphRenderer(l._terminal,l._colors,l._gl,l.dimensions),l.onCharSizeChanged(),l._isAttached=document.body.contains(l._core.screenElement),l}return o(e,t),Object.defineProperty(e.prototype,"onRequestRedraw",{get(){return this._onRequestRedraw.event},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onContextLoss",{get(){return this._onContextLoss.event},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){for(var e=0,i=this._renderLayers;i.length>e;e++)i[e].dispose();this._core.screenElement.removeChild(this._canvas),t.prototype.dispose.call(this)},Object.defineProperty(e.prototype,"textureAtlas",{get(){var t;return null===(t=this._charAtlas)||void 0===t?void 0:t.cacheCanvas},enumerable:!1,configurable:!0}),e.prototype.setColors=function(t){this._colors=t;for(var e=0,i=this._renderLayers;i.length>e;e++){var r=i[e];r.setColors(this._terminal,this._colors),r.reset(this._terminal)}this._rectangleRenderer.setColors(),this._glyphRenderer.setColors(),this._refreshCharAtlas(),this._model.clear()},e.prototype.onDevicePixelRatioChange=function(){this._devicePixelRatio!==window.devicePixelRatio&&(this._devicePixelRatio=window.devicePixelRatio,this.onResize(this._terminal.cols,this._terminal.rows))},e.prototype.onResize=function(t,e){this._updateDimensions(),this._model.resize(this._terminal.cols,this._terminal.rows);for(var i=0,r=this._renderLayers;r.length>i;i++)r[i].resize(this._terminal,this.dimensions);this._canvas.width=this.dimensions.scaledCanvasWidth,this._canvas.height=this.dimensions.scaledCanvasHeight,this._canvas.style.width=this.dimensions.canvasWidth+"px",this._canvas.style.height=this.dimensions.canvasHeight+"px",this._core.screenElement.style.width=this.dimensions.canvasWidth+"px",this._core.screenElement.style.height=this.dimensions.canvasHeight+"px",this._rectangleRenderer.onResize(),this._model.selection.hasSelection&&this._rectangleRenderer.updateSelection(this._model.selection),this._glyphRenderer.setDimensions(this.dimensions),this._glyphRenderer.onResize(),this._refreshCharAtlas(),this._model.clear()},e.prototype.onCharSizeChanged=function(){this.onResize(this._terminal.cols,this._terminal.rows)},e.prototype.onBlur=function(){for(var t=0,e=this._renderLayers;e.length>t;t++)e[t].onBlur(this._terminal)},e.prototype.onFocus=function(){for(var t=0,e=this._renderLayers;e.length>t;t++)e[t].onFocus(this._terminal)},e.prototype.onSelectionChanged=function(t,e,i){for(var r=0,o=this._renderLayers;o.length>r;r++)o[r].onSelectionChanged(this._terminal,t,e,i);this._updateSelectionModel(t,e,i),this._onRequestRedraw.fire({start:0,end:this._terminal.rows-1})},e.prototype.onCursorMove=function(){for(var t=0,e=this._renderLayers;e.length>t;t++)e[t].onCursorMove(this._terminal)},e.prototype.onOptionsChanged=function(){for(var t=0,e=this._renderLayers;e.length>t;t++)e[t].onOptionsChanged(this._terminal);this._updateDimensions(),this._refreshCharAtlas()},e.prototype._refreshCharAtlas=function(){if(this.dimensions.scaledCharWidth>0||this.dimensions.scaledCharHeight>0){var t=l.acquireCharAtlas(this._terminal,this._colors,this.dimensions.scaledCharWidth,this.dimensions.scaledCharHeight);if(!("getRasterizedGlyph"in t))throw Error("The webgl renderer only works with the webgl char atlas");this._charAtlas=t,this._charAtlas.warmUp(),this._glyphRenderer.setAtlas(this._charAtlas)}else this._isAttached=!1},e.prototype.clearCharAtlas=function(){var t;null===(t=this._charAtlas)||void 0===t||t.clearTexture(),this._model.clear(),this._updateModel(0,this._terminal.rows-1),this._onRequestRedraw.fire({start:0,end:this._terminal.rows-1})},e.prototype.clear=function(){for(var t=0,e=this._renderLayers;e.length>t;t++)e[t].reset(this._terminal)},e.prototype.registerCharacterJoiner=t=>-1,e.prototype.deregisterCharacterJoiner=t=>!1,e.prototype.renderRows=function(t,e){if(!this._isAttached){if(!(document.body.contains(this._core.screenElement)&&this._core._charSizeService.width&&this._core._charSizeService.height))return;this._updateDimensions(),this._refreshCharAtlas(),this._isAttached=!0}for(var i=0,r=this._renderLayers;r.length>i;i++)r[i].onGridChanged(this._terminal,t,e);this._glyphRenderer.beginFrame()&&(this._model.clear(),this._updateSelectionModel(void 0,void 0)),this._updateModel(t,e),this._rectangleRenderer.render(),this._glyphRenderer.render(this._model,this._model.selection.hasSelection)},e.prototype._updateModel=function(t,e){for(var i=this._core,r=this._workCell,o=t;e>=o;o++){var s=o+i.buffer.ydisp,n=i.buffer.lines.get(s);this._model.lineLengths[o]=0;for(var a=this._characterJoinerService.getJoinedCharacters(s),l=0;i.cols>l;l++){n.loadCell(l,r);var h=!1,_=l;if(a.length>0&&l===a[0][0]){h=!0;var u=a.shift();r=new C(r,n.translateToString(!0,u[0],u[1]),u[1]-u[0]),_=u[1]-1}var p=r.getChars(),f=r.getCode(),g=(o*i.cols+l)*c.RENDER_MODEL_INDICIES_PER_CELL;if(f!==d.NULL_CELL_CODE&&(this._model.lineLengths[o]=l+1),(this._model.cells[g]!==f||this._model.cells[g+c.RENDER_MODEL_BG_OFFSET]!==r.bg||this._model.cells[g+c.RENDER_MODEL_FG_OFFSET]!==r.fg)&&(p.length>1&&(f|=c.COMBINED_CHAR_BIT_MASK),this._model.cells[g]=f,this._model.cells[g+c.RENDER_MODEL_BG_OFFSET]=r.bg,this._model.cells[g+c.RENDER_MODEL_FG_OFFSET]=r.fg,this._glyphRenderer.updateCell(l,o,f,r.bg,r.fg,p),h))for(r=this._workCell,l++;_>l;l++){var v=(o*i.cols+l)*c.RENDER_MODEL_INDICIES_PER_CELL;this._glyphRenderer.updateCell(l,o,d.NULL_CELL_CODE,0,0,d.NULL_CELL_CHAR),this._model.cells[v]=d.NULL_CELL_CODE,this._model.cells[v+c.RENDER_MODEL_BG_OFFSET]=this._workCell.bg,this._model.cells[v+c.RENDER_MODEL_FG_OFFSET]=this._workCell.fg}}}this._rectangleRenderer.updateBackgrounds(this._model),this._model.selection.hasSelection&&this._glyphRenderer.updateSelection(this._model)},e.prototype._updateSelectionModel=function(t,e,i){void 0===i&&(i=!1);var r=this._terminal;if(!t||!e||t[0]===e[0]&&t[1]===e[1])return this._model.clearSelection(),void this._rectangleRenderer.updateSelection(this._model.selection);var o=t[1]-r.buffer.active.viewportY,s=e[1]-r.buffer.active.viewportY,n=Math.max(o,0),a=Math.min(s,r.rows-1);if(n>=r.rows||0>a)return this._model.clearSelection(),void this._rectangleRenderer.updateSelection(this._model.selection);this._model.selection.hasSelection=!0,this._model.selection.columnSelectMode=i,this._model.selection.viewportStartRow=o,this._model.selection.viewportEndRow=s,this._model.selection.viewportCappedStartRow=n,this._model.selection.viewportCappedEndRow=a,this._model.selection.startCol=t[0],this._model.selection.endCol=e[0],this._rectangleRenderer.updateSelection(this._model.selection)},e.prototype._updateDimensions=function(){this._core._charSizeService.width&&this._core._charSizeService.height&&(this.dimensions.scaledCharWidth=Math.floor(this._core._charSizeService.width*this._devicePixelRatio),this.dimensions.scaledCharHeight=Math.ceil(this._core._charSizeService.height*this._devicePixelRatio),this.dimensions.scaledCellHeight=Math.floor(this.dimensions.scaledCharHeight*this._terminal.getOption("lineHeight")),this.dimensions.scaledCharTop=1===this._terminal.getOption("lineHeight")?0:Math.round((this.dimensions.scaledCellHeight-this.dimensions.scaledCharHeight)/2),this.dimensions.scaledCellWidth=this.dimensions.scaledCharWidth+Math.round(this._terminal.getOption("letterSpacing")),this.dimensions.scaledCharLeft=Math.floor(this._terminal.getOption("letterSpacing")/2),this.dimensions.scaledCanvasHeight=this._terminal.rows*this.dimensions.scaledCellHeight,this.dimensions.scaledCanvasWidth=this._terminal.cols*this.dimensions.scaledCellWidth,this.dimensions.canvasHeight=Math.round(this.dimensions.scaledCanvasHeight/this._devicePixelRatio),this.dimensions.canvasWidth=Math.round(this.dimensions.scaledCanvasWidth/this._devicePixelRatio),this.dimensions.actualCellHeight=this.dimensions.scaledCellHeight/this._devicePixelRatio,this.dimensions.actualCellWidth=this.dimensions.scaledCellWidth/this._devicePixelRatio)},e}(_.Disposable);e.WebglRenderer=v;var C=function(t){function e(e,i,r){var o=t.call(this)||this;return o.content=0,o.combinedData="",o.fg=e.fg,o.bg=e.bg,o.combinedData=i,o._width=r,o}return o(e,t),e.prototype.isCombined=()=>2097152,e.prototype.getWidth=function(){return this._width},e.prototype.getChars=function(){return this.combinedData},e.prototype.getCode=()=>2097151,e.prototype.setFromCharData=t=>{throw Error("not implemented")},e.prototype.getAsCharData=function(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]},e}(g.AttributeData);e.JoinedCellData=C},381(t,e){function i(t,e,i){var o=r(t.createShader(e));if(t.shaderSource(o,i),t.compileShader(o),t.getShaderParameter(o,t.COMPILE_STATUS))return o;console.error(t.getShaderInfoLog(o)),t.deleteShader(o)}function r(t){if(!t)throw Error("value must not be falsy");return t}Object.defineProperty(e,"__esModule",{value:!0}),e.throwIfFalsy=e.expandFloat32Array=e.createShader=e.createProgram=e.PROJECTION_MATRIX=void 0,e.PROJECTION_MATRIX=new Float32Array([2,0,0,0,0,-2,0,0,0,0,1,0,-1,1,0,1]),e.createProgram=(t,e,o)=>{var s=r(t.createProgram());if(t.attachShader(s,r(i(t,t.VERTEX_SHADER,e))),t.attachShader(s,r(i(t,t.FRAGMENT_SHADER,o))),t.linkProgram(s),t.getProgramParameter(s,t.LINK_STATUS))return s;console.error(t.getProgramInfoLog(s)),t.deleteProgram(s)},e.createShader=i,e.expandFloat32Array=(t,e)=>{for(var i=new Float32Array(Math.min(2*t.length,e)),r=0;t.length>r;r++)i[r]=t[r];return i},e.throwIfFalsy=r},713(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.removeTerminalFromCache=e.acquireCharAtlas=void 0;var r=i(433),o=i(167),s=[];e.acquireCharAtlas=(t,e,i,n)=>{for(var a=r.generateConfig(i,n,t,e),l=0;s.length>l;l++){var h=(c=s[l]).ownedBy.indexOf(t);if(h>=0){if(r.configEquals(c.config,a))return c.atlas;1===c.ownedBy.length?(c.atlas.dispose(),s.splice(l,1)):c.ownedBy.splice(h,1);break}}for(l=0;s.length>l;l++){var c=s[l];if(r.configEquals(c.config,a))return c.ownedBy.push(t),c.atlas}var _={atlas:new o.WebglCharAtlas(document,a),config:a,ownedBy:[t]};return s.push(_),_.atlas},e.removeTerminalFromCache=t=>{for(var e=0;s.length>e;e++){var i=s[e].ownedBy.indexOf(t);if(-1!==i){1===s[e].ownedBy.length?(s[e].atlas.dispose(),s.splice(e,1)):s[e].ownedBy.splice(i,1);break}}}},433(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.is256Color=e.configEquals=e.generateConfig=void 0;var i={css:"",rgba:0};e.generateConfig=(t,e,r,o)=>{var s={foreground:o.foreground,background:o.background,cursor:i,cursorAccent:i,selectionTransparent:i,selectionOpaque:i,ansi:o.ansi.slice(),contrastCache:o.contrastCache};return{devicePixelRatio:window.devicePixelRatio,scaledCharWidth:t,scaledCharHeight:e,fontFamily:r.getOption("fontFamily"),fontSize:r.getOption("fontSize"),fontWeight:r.getOption("fontWeight"),fontWeightBold:r.getOption("fontWeightBold"),allowTransparency:r.getOption("allowTransparency"),drawBoldTextInBrightColors:r.getOption("drawBoldTextInBrightColors"),minimumContrastRatio:r.getOption("minimumContrastRatio"),colors:s}},e.configEquals=(t,e)=>{for(var i=0;t.colors.ansi.length>i;i++)if(t.colors.ansi[i].rgba!==e.colors.ansi[i].rgba)return!1;return t.devicePixelRatio===e.devicePixelRatio&&t.fontFamily===e.fontFamily&&t.fontSize===e.fontSize&&t.fontWeight===e.fontWeight&&t.fontWeightBold===e.fontWeightBold&&t.allowTransparency===e.allowTransparency&&t.scaledCharWidth===e.scaledCharWidth&&t.scaledCharHeight===e.scaledCharHeight&&t.drawBoldTextInBrightColors===e.drawBoldTextInBrightColors&&t.minimumContrastRatio===e.minimumContrastRatio&&t.colors.foreground===e.colors.foreground&&t.colors.background===e.colors.background},e.is256Color=t=>16777216==(50331648&t)||33554432==(50331648&t)},167(t,e,i){function r(t){var e=t.toString(16);return 2>e.length?"0"+e:e}Object.defineProperty(e,"__esModule",{value:!0}),e.WebglCharAtlas=void 0;var o=i(499),s=i(855),n=i(381),a=i(147),l=i(742),h=1024,c=1024,_={css:"rgba(0, 0, 0, 0)",rgba:0},d={offset:{x:0,y:0},texturePosition:{x:0,y:0},texturePositionClipSpace:{x:0,y:0},size:{x:0,y:0},sizeClipSpace:{x:0,y:0}},u=function(){function t(t,e){this._config=e,this._didWarmUp=!1,this._cacheMap={},this._cacheMapCombined={},this._currentRowY=0,this._currentRowX=0,this._currentRowHeight=0,this.hasCanvasChanged=!1,this._workBoundingBox={top:0,left:0,bottom:0,right:0},this._workAttributeData=new a.AttributeData,this.cacheCanvas=t.createElement("canvas"),this.cacheCanvas.width=h,this.cacheCanvas.height=c,this._cacheCtx=n.throwIfFalsy(this.cacheCanvas.getContext("2d",{alpha:!0})),this._tmpCanvas=t.createElement("canvas"),this._tmpCanvas.width=4*this._config.scaledCharWidth+4,this._tmpCanvas.height=this._config.scaledCharHeight+4,this._tmpCtx=n.throwIfFalsy(this._tmpCanvas.getContext("2d",{alpha:this._config.allowTransparency}))}return t.prototype.dispose=function(){this.cacheCanvas.parentElement&&this.cacheCanvas.parentElement.removeChild(this.cacheCanvas)},t.prototype.warmUp=function(){this._didWarmUp||(this._doWarmUp(),this._didWarmUp=!0)},t.prototype._doWarmUp=function(){for(var t,e,i=33;126>i;i++){var r=this._drawToCache(i,s.DEFAULT_COLOR,s.DEFAULT_COLOR);this._cacheMap[i]=((t={})[s.DEFAULT_COLOR]=((e={})[s.DEFAULT_COLOR]=r,e),t)}},t.prototype.beginFrame=function(){return this._currentRowY>819&&(this.clearTexture(),this.warmUp(),!0)},t.prototype.clearTexture=function(){0===this._currentRowX&&0===this._currentRowY||(this._cacheCtx.clearRect(0,0,h,c),this._cacheMap={},this._cacheMapCombined={},this._currentRowHeight=0,this._currentRowX=0,this._currentRowY=0,this._didWarmUp=!1)},t.prototype.getRasterizedGlyphCombinedChar=function(t,e,i){var r,o=this._cacheMapCombined[t];o||(this._cacheMapCombined[t]=o={});var s=o[e];return s&&(r=s[i]),r||(r=this._drawToCache(t,e,i),o[e]||(o[e]={}),o[e][i]=r),r},t.prototype.getRasterizedGlyph=function(t,e,i){var r,o=this._cacheMap[t];o||(this._cacheMap[t]=o={});var s=o[e];return s&&(r=s[i]),r||(r=this._drawToCache(t,e,i),o[e]||(o[e]={}),o[e][i]=r),r},t.prototype._getColorFromAnsiIndex=function(t){if(t>=this._config.colors.ansi.length)throw Error("No color found for idx "+t);return this._config.colors.ansi[t]},t.prototype._getBackgroundColor=function(t,e,i){if(this._config.allowTransparency)return _;switch(t){case 16777216:case 33554432:return this._getColorFromAnsiIndex(e);case 50331648:var o=a.AttributeData.toColorRGB(e);return{rgba:e<<8,css:"#"+r(o[0])+r(o[1])+r(o[2])};case 0:default:return i?this._config.colors.foreground:this._config.colors.background}},t.prototype._getForegroundCss=function(t,e,i,r,o,s,n,h){var c=this._getMinimumContrastCss(t,e,i,r,o,s,n,h);if(c)return c;switch(o){case 16777216:case 33554432:return this._config.drawBoldTextInBrightColors&&h&&8>s&&(s+=8),this._getColorFromAnsiIndex(s).css;case 50331648:var _=a.AttributeData.toColorRGB(s);return l.channels.toCss(_[0],_[1],_[2]);case 0:default:if(n){var d=this._config.colors.background.css;return 9===d.length?d.substr(0,7):d}return this._config.colors.foreground.css}},t.prototype._resolveBackgroundRgba=function(t,e,i){switch(t){case 16777216:case 33554432:return this._getColorFromAnsiIndex(e).rgba;case 50331648:return e<<8;case 0:default:return i?this._config.colors.foreground.rgba:this._config.colors.background.rgba}},t.prototype._resolveForegroundRgba=function(t,e,i,r){switch(t){case 16777216:case 33554432:return this._config.drawBoldTextInBrightColors&&r&&8>e&&(e+=8),this._getColorFromAnsiIndex(e).rgba;case 50331648:return e<<8;case 0:default:return i?this._config.colors.background.rgba:this._config.colors.foreground.rgba}},t.prototype._getMinimumContrastCss=function(t,e,i,r,o,s,n,a){if(1!==this._config.minimumContrastRatio){var h=this._config.colors.contrastCache.getCss(t,r);if(void 0!==h)return h||void 0;var c=this._resolveBackgroundRgba(e,i,n),_=this._resolveForegroundRgba(o,s,n,a),d=l.rgba.ensureContrastRatio(c,_,this._config.minimumContrastRatio);if(d){var u=l.channels.toCss(d>>24&255,d>>16&255,d>>8&255);return this._config.colors.contrastCache.setCss(t,r,u),u}this._config.colors.contrastCache.setCss(t,r,null)}},t.prototype._drawToCache=function(t,e,i){var r="number"==typeof t?String.fromCharCode(t):t;this.hasCanvasChanged=!0;var s=this._config.scaledCharWidth*Math.max(r.length,2)+4;if(s>this._tmpCanvas.width&&(this._tmpCanvas.width=s),this._tmpCtx.save(),this._workAttributeData.fg=i,this._workAttributeData.bg=e,this._workAttributeData.isInvisible())return d;var n=!!this._workAttributeData.isBold(),a=!!this._workAttributeData.isInverse(),l=!!this._workAttributeData.isDim(),_=!!this._workAttributeData.isItalic(),u=this._workAttributeData.getFgColor(),p=this._workAttributeData.getFgColorMode(),f=this._workAttributeData.getBgColor(),g=this._workAttributeData.getBgColorMode();if(a){var v=u;u=f,f=v;var C=p;p=g,g=C}var m=this._getBackgroundColor(g,f,a);this._tmpCtx.globalCompositeOperation="copy",this._tmpCtx.fillStyle=m.css,this._tmpCtx.fillRect(0,0,this._tmpCanvas.width,this._tmpCanvas.height),this._tmpCtx.globalCompositeOperation="source-over",this._tmpCtx.font=(_?"italic":"")+" "+(n?this._config.fontWeightBold:this._config.fontWeight)+" "+this._config.fontSize*this._config.devicePixelRatio+"px "+this._config.fontFamily,this._tmpCtx.textBaseline="ideographic",this._tmpCtx.fillStyle=this._getForegroundCss(e,g,f,i,p,u,a,n),l&&(this._tmpCtx.globalAlpha=o.DIM_OPACITY);var y=!1;if(1===r.length){var R=r.charCodeAt(0);R>=57504&&57558>=R&&(y=!0)}var b=y?0:2;this._tmpCtx.fillText(r,b,b+this._config.scaledCharHeight),this._tmpCtx.restore();var w=this._tmpCtx.getImageData(0,0,this._tmpCanvas.width,this._tmpCanvas.height);if(((t,e)=>{for(var i=!0,r=e.rgba>>>24,o=e.rgba>>>16&255,s=e.rgba>>>8&255,n=0;t.data.length>n;n+=4)t.data[n]===r&&t.data[n+1]===o&&t.data[n+2]===s?t.data[n+3]=0:i=!1;return i})(w,m))return d;var A=this._findGlyphBoundingBox(w,this._workBoundingBox,s,y),E=this._clipImageData(w,this._workBoundingBox);return this._currentRowX+this._config.scaledCharWidth>h&&(this._currentRowX=0,this._currentRowY+=this._currentRowHeight,this._currentRowHeight=0),A.texturePosition.x=this._currentRowX,A.texturePosition.y=this._currentRowY,A.texturePositionClipSpace.x=this._currentRowX/h,A.texturePositionClipSpace.y=this._currentRowY/c,this._currentRowHeight=Math.max(this._currentRowHeight,A.size.y),this._currentRowX+=A.size.x,this._cacheCtx.putImageData(E,A.texturePosition.x,A.texturePosition.y),A},t.prototype._findGlyphBoundingBox=function(t,e,i,r){e.top=0;for(var o=r?this._config.scaledCharHeight:this._tmpCanvas.height,s=r?this._config.scaledCharWidth:i,n=!1,a=0;o>a;a++){for(var l=0;s>l;l++){var _=a*this._tmpCanvas.width*4+4*l+3;if(0!==t.data[_]){e.top=a,n=!0;break}}if(n)break}for(e.left=0,n=!1,l=0;s>l;l++){for(a=0;o>a;a++)if(0!==t.data[_=a*this._tmpCanvas.width*4+4*l+3]){e.left=l,n=!0;break}if(n)break}for(e.right=s,n=!1,l=s-1;l>=0;l--){for(a=0;o>a;a++)if(0!==t.data[_=a*this._tmpCanvas.width*4+4*l+3]){e.right=l,n=!0;break}if(n)break}for(e.bottom=o,n=!1,a=o-1;a>=0;a--){for(l=0;s>l;l++)if(0!==t.data[_=a*this._tmpCanvas.width*4+4*l+3]){e.bottom=a,n=!0;break}if(n)break}return{texturePosition:{x:0,y:0},texturePositionClipSpace:{x:0,y:0},size:{x:e.right-e.left+1,y:e.bottom-e.top+1},sizeClipSpace:{x:(e.right-e.left+1)/h,y:(e.bottom-e.top+1)/c},offset:{x:(r?0:2)-e.left,y:(r?0:2)-e.top}}},t.prototype._clipImageData=function(t,e){for(var i=e.right-e.left+1,r=e.bottom-e.top+1,o=new Uint8ClampedArray(i*r*4),s=e.top;e.bottom>=s;s++)for(var n=e.left;e.right>=n;n++){var a=s*this._tmpCanvas.width*4+4*n,l=(s-e.top)*i*4+4*(n-e.left);o[l]=t.data[a],o[l+1]=t.data[a+1],o[l+2]=t.data[a+2],o[l+3]=t.data[a+3]}return new ImageData(o,i,r)},t}();e.WebglCharAtlas=u},592(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.BaseRenderLayer=void 0;var r=i(713),o=i(381),s=function(){function t(t,e,i,r,o){this._container=t,this._alpha=r,this._colors=o,this._scaledCharWidth=0,this._scaledCharHeight=0,this._scaledCellWidth=0,this._scaledCellHeight=0,this._scaledCharLeft=0,this._scaledCharTop=0,this._canvas=document.createElement("canvas"),this._canvas.classList.add("xterm-"+e+"-layer"),this._canvas.style.zIndex=""+i,this._initCanvas(),this._container.appendChild(this._canvas)}return t.prototype.dispose=function(){this._container.removeChild(this._canvas),this._charAtlas&&this._charAtlas.dispose()},t.prototype._initCanvas=function(){this._ctx=o.throwIfFalsy(this._canvas.getContext("2d",{alpha:this._alpha})),this._alpha||this._clearAll()},t.prototype.onOptionsChanged=t=>{},t.prototype.onBlur=t=>{},t.prototype.onFocus=t=>{},t.prototype.onCursorMove=t=>{},t.prototype.onGridChanged=(t,e,i)=>{},t.prototype.onSelectionChanged=(t,e,i,r)=>{void 0===r&&(r=!1)},t.prototype.setColors=function(t,e){this._refreshCharAtlas(t,e)},t.prototype._setTransparency=function(t,e){if(e!==this._alpha){var i=this._canvas;this._alpha=e,this._canvas=this._canvas.cloneNode(),this._initCanvas(),this._container.replaceChild(this._canvas,i),this._refreshCharAtlas(t,this._colors),this.onGridChanged(t,0,t.rows-1)}},t.prototype._refreshCharAtlas=function(t,e){0>=this._scaledCharWidth&&0>=this._scaledCharHeight||(this._charAtlas=r.acquireCharAtlas(t,e,this._scaledCharWidth,this._scaledCharHeight),this._charAtlas.warmUp())},t.prototype.resize=function(t,e){this._scaledCellWidth=e.scaledCellWidth,this._scaledCellHeight=e.scaledCellHeight,this._scaledCharWidth=e.scaledCharWidth,this._scaledCharHeight=e.scaledCharHeight,this._scaledCharLeft=e.scaledCharLeft,this._scaledCharTop=e.scaledCharTop,this._canvas.width=e.scaledCanvasWidth,this._canvas.height=e.scaledCanvasHeight,this._canvas.style.width=e.canvasWidth+"px",this._canvas.style.height=e.canvasHeight+"px",this._alpha||this._clearAll(),this._refreshCharAtlas(t,this._colors)},t.prototype._fillCells=function(t,e,i,r){this._ctx.fillRect(t*this._scaledCellWidth,e*this._scaledCellHeight,i*this._scaledCellWidth,r*this._scaledCellHeight)},t.prototype._fillBottomLineAtCells=function(t,e,i){void 0===i&&(i=1),this._ctx.fillRect(t*this._scaledCellWidth,(e+1)*this._scaledCellHeight-window.devicePixelRatio-1,i*this._scaledCellWidth,window.devicePixelRatio)},t.prototype._fillLeftLineAtCell=function(t,e,i){this._ctx.fillRect(t*this._scaledCellWidth,e*this._scaledCellHeight,window.devicePixelRatio*i,this._scaledCellHeight)},t.prototype._strokeRectAtCell=function(t,e,i,r){this._ctx.lineWidth=window.devicePixelRatio,this._ctx.strokeRect(t*this._scaledCellWidth+window.devicePixelRatio/2,e*this._scaledCellHeight+window.devicePixelRatio/2,i*this._scaledCellWidth-window.devicePixelRatio,r*this._scaledCellHeight-window.devicePixelRatio)},t.prototype._clearAll=function(){this._alpha?this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height):(this._ctx.fillStyle=this._colors.background.css,this._ctx.fillRect(0,0,this._canvas.width,this._canvas.height))},t.prototype._clearCells=function(t,e,i,r){this._alpha?this._ctx.clearRect(t*this._scaledCellWidth,e*this._scaledCellHeight,i*this._scaledCellWidth,r*this._scaledCellHeight):(this._ctx.fillStyle=this._colors.background.css,this._ctx.fillRect(t*this._scaledCellWidth,e*this._scaledCellHeight,i*this._scaledCellWidth,r*this._scaledCellHeight))},t.prototype._fillCharTrueColor=function(t,e,i,r){this._ctx.font=this._getFont(t,!1,!1),this._ctx.textBaseline="ideographic",this._clipRow(t,r),this._ctx.fillText(e.getChars(),i*this._scaledCellWidth+this._scaledCharLeft,r*this._scaledCellHeight+this._scaledCharTop+this._scaledCharHeight)},t.prototype._clipRow=function(t,e){this._ctx.beginPath(),this._ctx.rect(0,e*this._scaledCellHeight,t.cols*this._scaledCellWidth,this._scaledCellHeight),this._ctx.clip()},t.prototype._getFont=(t,e,i)=>(i?"italic":"")+" "+t.getOption(e?"fontWeightBold":"fontWeight")+" "+t.getOption("fontSize")*window.devicePixelRatio+"px "+t.getOption("fontFamily"),t}();e.BaseRenderLayer=s},461(t,e,i){function r(t){return document.activeElement===t.textarea&&document.hasFocus()}var o,s=this&&this.__extends||(o=(t,e)=>(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&((t,e)=>{t.__proto__=e})||((t,e)=>{for(var i in e)({}).hasOwnProperty.call(e,i)&&(t[i]=e[i])}))(t,e),function(t,e){function i(){this.constructor=t}if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+e+" is not a constructor or null");o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.CursorRenderLayer=void 0;var n=i(592),a=i(782),l=600,h=function(t){function e(e,i,r,o){var s=t.call(this,e,"cursor",i,!0,r)||this;return s._onRequestRefreshRowsEvent=o,s._cell=new a.CellData,s._state={x:0,y:0,isFocused:!1,style:"",width:0},s._cursorRenderers={bar:s._renderBarCursor.bind(s),block:s._renderBlockCursor.bind(s),underline:s._renderUnderlineCursor.bind(s)},s}return s(e,t),e.prototype.resize=function(e,i){t.prototype.resize.call(this,e,i),this._state={x:0,y:0,isFocused:!1,style:"",width:0}},e.prototype.reset=function(t){this._clearCursor(),this._cursorBlinkStateManager&&(this._cursorBlinkStateManager.dispose(),this.onOptionsChanged(t))},e.prototype.onBlur=function(t){this._cursorBlinkStateManager&&this._cursorBlinkStateManager.pause(),this._onRequestRefreshRowsEvent.fire({start:t.buffer.active.cursorY,end:t.buffer.active.cursorY})},e.prototype.onFocus=function(t){this._cursorBlinkStateManager?this._cursorBlinkStateManager.resume(t):this._onRequestRefreshRowsEvent.fire({start:t.buffer.active.cursorY,end:t.buffer.active.cursorY})},e.prototype.onOptionsChanged=function(t){var e,i=this;t.getOption("cursorBlink")?this._cursorBlinkStateManager||(this._cursorBlinkStateManager=new c(t,(()=>{i._render(t,!0)}))):(null===(e=this._cursorBlinkStateManager)||void 0===e||e.dispose(),this._cursorBlinkStateManager=void 0),this._onRequestRefreshRowsEvent.fire({start:t.buffer.active.cursorY,end:t.buffer.active.cursorY})},e.prototype.onCursorMove=function(t){this._cursorBlinkStateManager&&this._cursorBlinkStateManager.restartBlinkAnimation(t)},e.prototype.onGridChanged=function(t,e,i){!this._cursorBlinkStateManager||this._cursorBlinkStateManager.isPaused?this._render(t,!1):this._cursorBlinkStateManager.restartBlinkAnimation(t)},e.prototype._render=function(t,e){if(t._core._coreService.isCursorInitialized&&!t._core._coreService.isCursorHidden){var i=t.buffer.active.baseY+t.buffer.active.cursorY,o=i-t.buffer.active.viewportY,s=Math.min(t.buffer.active.cursorX,t.cols-1);if(0>o||o>=t.rows)this._clearCursor();else if(t._core.buffer.lines.get(i).loadCell(s,this._cell),void 0!==this._cell.content){if(!r(t)){this._clearCursor(),this._ctx.save(),this._ctx.fillStyle=this._colors.cursor.css;var n=t.getOption("cursorStyle");return n&&"block"!==n?this._cursorRenderers[n](t,s,o,this._cell):this._renderBlurCursor(t,s,o,this._cell),this._ctx.restore(),this._state.x=s,this._state.y=o,this._state.isFocused=!1,this._state.style=n,void(this._state.width=this._cell.getWidth())}if(!this._cursorBlinkStateManager||this._cursorBlinkStateManager.isCursorVisible){if(this._state){if(this._state.x===s&&this._state.y===o&&this._state.isFocused===r(t)&&this._state.style===t.getOption("cursorStyle")&&this._state.width===this._cell.getWidth())return;this._clearCursor()}this._ctx.save(),this._cursorRenderers[t.getOption("cursorStyle")||"block"](t,s,o,this._cell),this._ctx.restore(),this._state.x=s,this._state.y=o,this._state.isFocused=!1,this._state.style=t.getOption("cursorStyle"),this._state.width=this._cell.getWidth()}else this._clearCursor()}}else this._clearCursor()},e.prototype._clearCursor=function(){this._state&&(this._clearCells(this._state.x,this._state.y,this._state.width,1),this._state={x:0,y:0,isFocused:!1,style:"",width:0})},e.prototype._renderBarCursor=function(t,e,i,r){this._ctx.save(),this._ctx.fillStyle=this._colors.cursor.css,this._fillLeftLineAtCell(e,i,t.getOption("cursorWidth")),this._ctx.restore()},e.prototype._renderBlockCursor=function(t,e,i,r){this._ctx.save(),this._ctx.fillStyle=this._colors.cursor.css,this._fillCells(e,i,r.getWidth(),1),this._ctx.fillStyle=this._colors.cursorAccent.css,this._fillCharTrueColor(t,r,e,i),this._ctx.restore()},e.prototype._renderUnderlineCursor=function(t,e,i,r){this._ctx.save(),this._ctx.fillStyle=this._colors.cursor.css,this._fillBottomLineAtCells(e,i),this._ctx.restore()},e.prototype._renderBlurCursor=function(t,e,i,r){this._ctx.save(),this._ctx.strokeStyle=this._colors.cursor.css,this._strokeRectAtCell(e,i,r.getWidth(),1),this._ctx.restore()},e}(n.BaseRenderLayer);e.CursorRenderLayer=h;var c=function(){function t(t,e){this._renderCallback=e,this.isCursorVisible=!0,r(t)&&this._restartInterval()}return Object.defineProperty(t.prototype,"isPaused",{get(){return!(this._blinkStartTimeout||this._blinkInterval)},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){this._blinkInterval&&(window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout&&(window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=void 0),this._animationFrame&&(window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)},t.prototype.restartBlinkAnimation=function(t){var e=this;this.isPaused||(this._animationTimeRestarted=Date.now(),this.isCursorVisible=!0,this._animationFrame||(this._animationFrame=window.requestAnimationFrame((()=>{e._renderCallback(),e._animationFrame=void 0}))))},t.prototype._restartInterval=function(t){var e=this;void 0===t&&(t=l),this._blinkInterval&&window.clearInterval(this._blinkInterval),this._blinkStartTimeout=window.setTimeout((()=>{if(e._animationTimeRestarted){var t=l-(Date.now()-e._animationTimeRestarted);if(e._animationTimeRestarted=void 0,t>0)return void e._restartInterval(t)}e.isCursorVisible=!1,e._animationFrame=window.requestAnimationFrame((()=>{e._renderCallback(),e._animationFrame=void 0})),e._blinkInterval=window.setInterval((()=>{if(e._animationTimeRestarted){var t=l-(Date.now()-e._animationTimeRestarted);return e._animationTimeRestarted=void 0,void e._restartInterval(t)}e.isCursorVisible=!e.isCursorVisible,e._animationFrame=window.requestAnimationFrame((()=>{e._renderCallback(),e._animationFrame=void 0}))}),l)}),t)},t.prototype.pause=function(){this.isCursorVisible=!0,this._blinkInterval&&(window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout&&(window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=void 0),this._animationFrame&&(window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)},t.prototype.resume=function(t){this.pause(),this._animationTimeRestarted=void 0,this._restartInterval(),this.restartBlinkAnimation(t)},t}()},733(t,e,i){var r,o=this&&this.__extends||(r=(t,e)=>(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&((t,e)=>{t.__proto__=e})||((t,e)=>{for(var i in e)({}).hasOwnProperty.call(e,i)&&(t[i]=e[i])}))(t,e),function(t,e){function i(){this.constructor=t}if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+e+" is not a constructor or null");r(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.LinkRenderLayer=void 0;var s=i(592),n=i(499),a=i(433),l=function(t){function e(e,i,r,o){var s=t.call(this,e,"link",i,!0,r)||this;return o.linkifier.onShowLinkUnderline((t=>s._onShowLinkUnderline(t))),o.linkifier.onHideLinkUnderline((t=>s._onHideLinkUnderline(t))),o.linkifier2.onShowLinkUnderline((t=>s._onShowLinkUnderline(t))),o.linkifier2.onHideLinkUnderline((t=>s._onHideLinkUnderline(t))),s}return o(e,t),e.prototype.resize=function(e,i){t.prototype.resize.call(this,e,i),this._state=void 0},e.prototype.reset=function(t){this._clearCurrentLink()},e.prototype._clearCurrentLink=function(){if(this._state){this._clearCells(this._state.x1,this._state.y1,this._state.cols-this._state.x1,1);var t=this._state.y2-this._state.y1-1;t>0&&this._clearCells(0,this._state.y1+1,this._state.cols,t),this._clearCells(0,this._state.y2,this._state.x2,1),this._state=void 0}},e.prototype._onShowLinkUnderline=function(t){if(this._ctx.fillStyle=t.fg===n.INVERTED_DEFAULT_COLOR?this._colors.background.css:void 0!==t.fg&&a.is256Color(t.fg)?this._colors.ansi[t.fg].css:this._colors.foreground.css,t.y1===t.y2)this._fillBottomLineAtCells(t.x1,t.y1,t.x2-t.x1);else{this._fillBottomLineAtCells(t.x1,t.y1,t.cols-t.x1);for(var e=t.y1+1;t.y2>e;e++)this._fillBottomLineAtCells(0,e,t.cols);this._fillBottomLineAtCells(0,t.y2,t.x2)}this._state=t},e.prototype._onHideLinkUnderline=function(t){this._clearCurrentLink()},e}(s.BaseRenderLayer);e.LinkRenderLayer=l},742(t,e){function i(t){var e=t.toString(16);return 2>e.length?"0"+e:e}function r(t,e){return e>t?(e+.05)/(t+.05):(t+.05)/(e+.05)}var o,s,n,a,l;Object.defineProperty(e,"__esModule",{value:!0}),e.contrastRatio=e.toPaddedHex=e.rgba=e.rgb=e.css=e.color=e.channels=void 0,(l=o=e.channels||(e.channels={})).toCss=(t,e,r,o)=>void 0!==o?"#"+i(t)+i(e)+i(r)+i(o):"#"+i(t)+i(e)+i(r),l.toRgba=(t,e,i,r)=>(void 0===r&&(r=255),(t<<24|e<<16|i<<8|r)>>>0),(s=e.color||(e.color={})).blend=(t,e)=>{var i=(255&e.rgba)/255;if(1===i)return{css:e.css,rgba:e.rgba};var r=e.rgba>>16&255,s=e.rgba>>8&255,n=t.rgba>>24&255,a=t.rgba>>16&255,l=t.rgba>>8&255,h=n+Math.round(((e.rgba>>24&255)-n)*i),c=a+Math.round((r-a)*i),_=l+Math.round((s-l)*i);return{css:o.toCss(h,c,_),rgba:o.toRgba(h,c,_)}},s.isOpaque=t=>255==(255&t.rgba),s.ensureContrastRatio=(t,e,i)=>{var r=a.ensureContrastRatio(t.rgba,e.rgba,i);if(r)return a.toColor(r>>24&255,r>>16&255,r>>8&255)},s.opaque=t=>{var e=(255|t.rgba)>>>0,i=a.toChannels(e);return{css:o.toCss(i[0],i[1],i[2]),rgba:e}},s.opacity=(t,e)=>{var i=Math.round(255*e),r=a.toChannels(t.rgba),s=r[0],n=r[1],l=r[2];return{css:o.toCss(s,n,l,i),rgba:o.toRgba(s,n,l,i)}},(e.css||(e.css={})).toColor=t=>{switch(t.length){case 7:return{css:t,rgba:(parseInt(t.slice(1),16)<<8|255)>>>0};case 9:return{css:t,rgba:parseInt(t.slice(1),16)>>>0}}throw Error("css.toColor: Unsupported css format")},(t=>{function e(t,e,i){var r=t/255,o=e/255,s=i/255;return.2126*(r>.03928?Math.pow((r+.055)/1.055,2.4):r/12.92)+.7152*(o>.03928?Math.pow((o+.055)/1.055,2.4):o/12.92)+.0722*(s>.03928?Math.pow((s+.055)/1.055,2.4):s/12.92)}t.relativeLuminance=t=>e(t>>16&255,t>>8&255,255&t),t.relativeLuminance2=e})(n=e.rgb||(e.rgb={})),(t=>{function e(t,e,i){for(var o=t>>24&255,s=t>>16&255,a=t>>8&255,l=e>>24&255,h=e>>16&255,c=e>>8&255,_=r(n.relativeLuminance2(l,c,h),n.relativeLuminance2(o,s,a));i>_&&(l>0||h>0||c>0);)l-=Math.max(0,Math.ceil(.1*l)),h-=Math.max(0,Math.ceil(.1*h)),_=r(n.relativeLuminance2(l,c-=Math.max(0,Math.ceil(.1*c)),h),n.relativeLuminance2(o,s,a));return(l<<24|h<<16|c<<8|255)>>>0}function i(t,e,i){for(var o=t>>24&255,s=t>>16&255,a=t>>8&255,l=e>>24&255,h=e>>16&255,c=e>>8&255,_=r(n.relativeLuminance2(l,c,h),n.relativeLuminance2(o,s,a));i>_&&(255>l||255>h||255>c);)l=Math.min(255,l+Math.ceil(.1*(255-l))),h=Math.min(255,h+Math.ceil(.1*(255-h))),_=r(n.relativeLuminance2(l,c=Math.min(255,c+Math.ceil(.1*(255-c))),h),n.relativeLuminance2(o,s,a));return(l<<24|h<<16|c<<8|255)>>>0}t.ensureContrastRatio=(t,o,s)=>{var a=n.relativeLuminance(t>>8),l=n.relativeLuminance(o>>8);if(r(a,l)<s)return a>l?e(t,o,s):i(t,o,s)},t.reduceLuminance=e,t.increaseLuminance=i,t.toChannels=t=>[t>>24&255,t>>16&255,t>>8&255,255&t],t.toColor=(t,e,i)=>({css:o.toCss(t,e,i),rgba:o.toRgba(t,e,i)})})(a=e.rgba||(e.rgba={})),e.toPaddedHex=i,e.contrastRatio=r},820(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.addDisposableDomListener=void 0,e.addDisposableDomListener=(t,e,i,r)=>{t.addEventListener(e,i,r);var o=!1;return{dispose(){o||(o=!0,t.removeEventListener(e,i,r))}}}},499(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.CHAR_ATLAS_CELL_SPACING=e.DIM_OPACITY=e.INVERTED_DEFAULT_COLOR=void 0,e.INVERTED_DEFAULT_COLOR=257,e.DIM_OPACITY=.5,e.CHAR_ATLAS_CELL_SPACING=1},345(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.forwardEvent=e.EventEmitter=void 0;var i=function(){function t(){this._listeners=[],this._disposed=!1}return Object.defineProperty(t.prototype,"event",{get(){var t=this;return this._event||(this._event=e=>(t._listeners.push(e),{dispose(){if(!t._disposed)for(var i=0;t._listeners.length>i;i++)if(t._listeners[i]===e)return void t._listeners.splice(i,1)}})),this._event},enumerable:!1,configurable:!0}),t.prototype.fire=function(t,e){for(var i=[],r=0;this._listeners.length>r;r++)i.push(this._listeners[r]);for(r=0;i.length>r;r++)i[r].call(void 0,t,e)},t.prototype.dispose=function(){this._listeners&&(this._listeners.length=0),this._disposed=!0},t}();e.EventEmitter=i,e.forwardEvent=(t,e)=>t((t=>e.fire(t)))},859(t,e){function i(t){for(var e=0,i=t;i.length>e;e++)i[e].dispose();t.length=0}Object.defineProperty(e,"__esModule",{value:!0}),e.getDisposeArrayDisposable=e.disposeArray=e.Disposable=void 0;var r=function(){function t(){this._disposables=[],this._isDisposed=!1}return t.prototype.dispose=function(){this._isDisposed=!0;for(var t=0,e=this._disposables;e.length>t;t++)e[t].dispose();this._disposables.length=0},t.prototype.register=function(t){return this._disposables.push(t),t},t.prototype.unregister=function(t){var e=this._disposables.indexOf(t);-1!==e&&this._disposables.splice(e,1)},t}();e.Disposable=r,e.disposeArray=i,e.getDisposeArrayDisposable=t=>({dispose:()=>i(t)})},455(t,e){function i(t,e,i,r){if(void 0===i&&(i=0),void 0===r&&(r=t.length),i>=t.length)return t;r=t.length>r?(t.length+r)%t.length:t.length;for(var o=i=(t.length+i)%t.length;r>o;++o)t[o]=e;return t}Object.defineProperty(e,"__esModule",{value:!0}),e.concat=e.fillFallback=e.fill=void 0,e.fill=(t,e,r,o)=>t.fill?t.fill(e,r,o):i(t,e,r,o),e.fillFallback=i,e.concat=(t,e)=>{var i=new t.constructor(t.length+e.length);return i.set(t),i.set(e,t.length),i}},147(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.ExtendedAttrs=e.AttributeData=void 0;var i=function(){function t(){this.fg=0,this.bg=0,this.extended=new r}return t.toColorRGB=t=>[t>>>16&255,t>>>8&255,255&t],t.fromColorRGB=t=>(255&t[0])<<16|(255&t[1])<<8|255&t[2],t.prototype.clone=function(){var e=new t;return e.fg=this.fg,e.bg=this.bg,e.extended=this.extended.clone(),e},t.prototype.isInverse=function(){return 67108864&this.fg},t.prototype.isBold=function(){return 134217728&this.fg},t.prototype.isUnderline=function(){return 268435456&this.fg},t.prototype.isBlink=function(){return 536870912&this.fg},t.prototype.isInvisible=function(){return 1073741824&this.fg},t.prototype.isItalic=function(){return 67108864&this.bg},t.prototype.isDim=function(){return 134217728&this.bg},t.prototype.getFgColorMode=function(){return 50331648&this.fg},t.prototype.getBgColorMode=function(){return 50331648&this.bg},t.prototype.isFgRGB=function(){return 50331648==(50331648&this.fg)},t.prototype.isBgRGB=function(){return 50331648==(50331648&this.bg)},t.prototype.isFgPalette=function(){return 16777216==(50331648&this.fg)||33554432==(50331648&this.fg)},t.prototype.isBgPalette=function(){return 16777216==(50331648&this.bg)||33554432==(50331648&this.bg)},t.prototype.isFgDefault=function(){return 0==(50331648&this.fg)},t.prototype.isBgDefault=function(){return 0==(50331648&this.bg)},t.prototype.isAttributeDefault=function(){return 0===this.fg&&0===this.bg},t.prototype.getFgColor=function(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}},t.prototype.getBgColor=function(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}},t.prototype.hasExtendedAttrs=function(){return 268435456&this.bg},t.prototype.updateExtended=function(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456},t.prototype.getUnderlineColor=function(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()},t.prototype.getUnderlineColorMode=function(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()},t.prototype.isUnderlineColorRGB=function(){return 268435456&this.bg&&~this.extended.underlineColor?50331648==(50331648&this.extended.underlineColor):this.isFgRGB()},t.prototype.isUnderlineColorPalette=function(){return 268435456&this.bg&&~this.extended.underlineColor?16777216==(50331648&this.extended.underlineColor)||33554432==(50331648&this.extended.underlineColor):this.isFgPalette()},t.prototype.isUnderlineColorDefault=function(){return 268435456&this.bg&&~this.extended.underlineColor?0==(50331648&this.extended.underlineColor):this.isFgDefault()},t.prototype.getUnderlineStyle=function(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0},t}();e.AttributeData=i;var r=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=-1),this.underlineStyle=t,this.underlineColor=e}return t.prototype.clone=function(){return new t(this.underlineStyle,this.underlineColor)},t.prototype.isEmpty=function(){return 0===this.underlineStyle},t}();e.ExtendedAttrs=r},782(t,e,i){var r,o=this&&this.__extends||(r=(t,e)=>(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&((t,e)=>{t.__proto__=e})||((t,e)=>{for(var i in e)({}).hasOwnProperty.call(e,i)&&(t[i]=e[i])}))(t,e),function(t,e){function i(){this.constructor=t}if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+e+" is not a constructor or null");r(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.CellData=void 0;var s=i(133),n=i(855),a=i(147),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.content=0,e.fg=0,e.bg=0,e.extended=new a.ExtendedAttrs,e.combinedData="",e}return o(e,t),e.fromCharData=t=>{var i=new e;return i.setFromCharData(t),i},e.prototype.isCombined=function(){return 2097152&this.content},e.prototype.getWidth=function(){return this.content>>22},e.prototype.getChars=function(){return 2097152&this.content?this.combinedData:2097151&this.content?s.stringFromCodePoint(2097151&this.content):""},e.prototype.getCode=function(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content},e.prototype.setFromCharData=function(t){this.fg=t[n.CHAR_DATA_ATTR_INDEX],this.bg=0;var e=!1;if(t[n.CHAR_DATA_CHAR_INDEX].length>2)e=!0;else if(2===t[n.CHAR_DATA_CHAR_INDEX].length){var i=t[n.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296>i||i>56319)e=!0;else{var r=t[n.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320>r||r>57343?e=!0:this.content=1024*(i-55296)+r-56320+65536|t[n.CHAR_DATA_WIDTH_INDEX]<<22}}else this.content=t[n.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|t[n.CHAR_DATA_WIDTH_INDEX]<<22;e&&(this.combinedData=t[n.CHAR_DATA_CHAR_INDEX],this.content=2097152|t[n.CHAR_DATA_WIDTH_INDEX]<<22)},e.prototype.getAsCharData=function(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]},e}(a.AttributeData);e.CellData=l},855(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.WHITESPACE_CELL_CODE=e.WHITESPACE_CELL_WIDTH=e.WHITESPACE_CELL_CHAR=e.NULL_CELL_CODE=e.NULL_CELL_WIDTH=e.NULL_CELL_CHAR=e.CHAR_DATA_CODE_INDEX=e.CHAR_DATA_WIDTH_INDEX=e.CHAR_DATA_CHAR_INDEX=e.CHAR_DATA_ATTR_INDEX=e.DEFAULT_ATTR=e.DEFAULT_COLOR=void 0,e.DEFAULT_COLOR=256,e.DEFAULT_ATTR=256|e.DEFAULT_COLOR<<9,e.CHAR_DATA_ATTR_INDEX=0,e.CHAR_DATA_CHAR_INDEX=1,e.CHAR_DATA_WIDTH_INDEX=2,e.CHAR_DATA_CODE_INDEX=3,e.NULL_CELL_CHAR="",e.NULL_CELL_WIDTH=1,e.NULL_CELL_CODE=0,e.WHITESPACE_CELL_CHAR=" ",e.WHITESPACE_CELL_WIDTH=1,e.WHITESPACE_CELL_CODE=32},133(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Utf8ToUtf32=e.StringToUtf32=e.utf32ToString=e.stringFromCodePoint=void 0,e.stringFromCodePoint=t=>t>65535?String.fromCharCode(55296+((t-=65536)>>10))+String.fromCharCode(t%1024+56320):String.fromCharCode(t),e.utf32ToString=(t,e,i)=>{void 0===e&&(e=0),void 0===i&&(i=t.length);for(var r="",o=e;i>o;++o){var s=t[o];r+=s>65535?String.fromCharCode(55296+((s-=65536)>>10))+String.fromCharCode(s%1024+56320):String.fromCharCode(s)}return r};var i=function(){function t(){this._interim=0}return t.prototype.clear=function(){this._interim=0},t.prototype.decode=function(t,e){var i=t.length;if(!i)return 0;var r=0,o=0;this._interim&&(56320>(a=t.charCodeAt(o++))||a>57343?(e[r++]=this._interim,e[r++]=a):e[r++]=1024*(this._interim-55296)+a-56320+65536,this._interim=0);for(var s=o;i>s;++s){var n=t.charCodeAt(s);if(55296>n||n>56319)65279!==n&&(e[r++]=n);else{if(++s>=i)return this._interim=n,r;var a;56320>(a=t.charCodeAt(s))||a>57343?(e[r++]=n,e[r++]=a):e[r++]=1024*(n-55296)+a-56320+65536}}return r},t}();e.StringToUtf32=i;var r=function(){function t(){this.interim=new Uint8Array(3)}return t.prototype.clear=function(){this.interim.fill(0)},t.prototype.decode=function(t,e){var i=t.length;if(!i)return 0;var r,o,s,n,a=0,l=0,h=0;if(this.interim[0]){var c=!1,_=this.interim[0];_&=192==(224&_)?31:224==(240&_)?15:7;for(var d=0,u=void 0;(u=63&this.interim[++d])&&4>d;)_<<=6,_|=u;for(var p=192==(224&this.interim[0])?2:224==(240&this.interim[0])?3:4,f=p-d;f>h;){if(h>=i)return 0;if(128!=(192&(u=t[h++]))){h--,c=!0;break}this.interim[d++]=u,_<<=6,_|=63&u}c||(2===p?128>_?h--:e[a++]=_:3===p?2048>_||_>=55296&&57343>=_||65279===_||(e[a++]=_):65536>_||_>1114111||(e[a++]=_)),this.interim.fill(0)}for(var g=i-4,v=h;i>v;){for(;!(v>=g||128&(r=t[v])||128&(o=t[v+1])||128&(s=t[v+2])||128&(n=t[v+3]));)e[a++]=r,e[a++]=o,e[a++]=s,e[a++]=n,v+=4;if(128>(r=t[v++]))e[a++]=r;else if(192==(224&r)){if(v>=i)return this.interim[0]=r,a;if(128!=(192&(o=t[v++]))){v--;continue}if(128>(l=(31&r)<<6|63&o)){v--;continue}e[a++]=l}else if(224==(240&r)){if(v>=i)return this.interim[0]=r,a;if(128!=(192&(o=t[v++]))){v--;continue}if(v>=i)return this.interim[0]=r,this.interim[1]=o,a;if(128!=(192&(s=t[v++]))){v--;continue}if(2048>(l=(15&r)<<12|(63&o)<<6|63&s)||l>=55296&&57343>=l||65279===l)continue;e[a++]=l}else if(240==(248&r)){if(v>=i)return this.interim[0]=r,a;if(128!=(192&(o=t[v++]))){v--;continue}if(v>=i)return this.interim[0]=r,this.interim[1]=o,a;if(128!=(192&(s=t[v++]))){v--;continue}if(v>=i)return this.interim[0]=r,this.interim[1]=o,this.interim[2]=s,a;if(128!=(192&(n=t[v++]))){v--;continue}if(65536>(l=(7&r)<<18|(63&o)<<12|(63&s)<<6|63&n)||l>1114111)continue;e[a++]=l}}return a},t}();e.Utf8ToUtf32=r}},i={},r={};return(()=>{var e=r;Object.defineProperty(e,"__esModule",{value:!0}),e.WebglAddon=void 0;var i=t(666),o=t(345),s=function(){function t(t){this._preserveDrawingBuffer=t,this._onContextLoss=new o.EventEmitter}return Object.defineProperty(t.prototype,"onContextLoss",{get(){return this._onContextLoss.event},enumerable:!1,configurable:!0}),t.prototype.activate=function(t){var e=this;if(!t.element)throw Error("Cannot activate WebglAddon before Terminal.open");this._terminal=t;var r=t._core._renderService;this._renderer=new i.WebglRenderer(t,t._core._colorManager.colors,t._core._characterJoinerService,this._preserveDrawingBuffer),this._renderer.onContextLoss((()=>e._onContextLoss.fire())),r.setRenderer(this._renderer)},t.prototype.dispose=function(){if(!this._terminal)throw Error("Cannot dispose WebglAddon because it is activated");var t=this._terminal._core._renderService;t.setRenderer(this._terminal._core._createRenderer()),t.onResize(this._terminal.cols,this._terminal.rows),this._renderer=void 0},Object.defineProperty(t.prototype,"textureAtlas",{get(){var t;return null===(t=this._renderer)||void 0===t?void 0:t.textureAtlas},enumerable:!1,configurable:!0}),t.prototype.clearTextureAtlas=function(){var t;null===(t=this._renderer)||void 0===t||t.clearCharAtlas()},t}();e.WebglAddon=s})(),r})()},"object"==typeof t.exports?t.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof t.exports?t.exports.WebglAddon=r():i.WebglAddon=r()}));
//# sourceMappingURL=xterm-addon-webgl.080d16c5.js.map
